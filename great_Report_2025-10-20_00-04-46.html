
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auction Item Analysis</title>
    <style>
        :root {
            --bg-color: #1a1a1a; --table-bg-color: #2c2c2c; --header-bg-color: #3a3a3a;
            --header-hover-bg-color: #4a4a4a; --row-even-bg-color: #333333; --row-odd-bg-color: #2c2c2c;
            --border-color: #444444; --text-color: #e0e0e0; --link-color: #4a90e2;
            --link-hover-color: #81b5f5; --sort-indicator-color: #81b5f5;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 2rem; line-height: 1.6; }
        h1 { text-align: center; color: #ffffff; font-weight: 300; margin-bottom: 2rem; }
        .table-container { max-width: 1600px; margin: auto; overflow-x: auto; border-radius: 8px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); }
        table { width: 100%; border-collapse: collapse; background-color: var(--table-bg-color); border-spacing: 0; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid var(--border-color); }
        thead th { background-color: var(--header-bg-color); color: #ffffff; font-weight: 600; position: sticky; top: 0; z-index: 10; }
        thead th[data-column] { cursor: pointer; transition: background-color 0.2s ease-in-out; user-select: none; }
        thead th[data-column]:hover { background-color: var(--header-hover-bg-color); }
        tbody tr:not(.reasoning-row):hover { background-color: var(--header-hover-bg-color); }
        td { font-size: 0.95em; }
        td:nth-child(4), td:nth-child(5), td:nth-child(6) { font-family: 'Courier New', Courier, monospace; text-align: right; white-space: nowrap; }
        td:nth-child(7), td:nth-child(8) { text-align: center; }
        a { color: var(--link-color); text-decoration: none; transition: color 0.2s ease-in-out; }
        a:hover { color: var(--link-hover-color); text-decoration: underline; }
        .sort-indicator { color: var(--sort-indicator-color); font-size: 0.8em; margin-left: 8px; display: inline-block; width: 10px; }
        .lot-main td { font-weight: bold; }
        .lot-main.expandable { cursor: pointer; }
        .lot-main:nth-child(4n+1), .lot-main:nth-child(4n+2) { background-color: var(--row-odd-bg-color); }
        .lot-main:nth-child(4n+3), .lot-main:nth-child(4n) { background-color: var(--row-even-bg-color); }
        .lot-sub-item { background-color: rgba(0,0,0,0.15) !important; }
        .lot-sub-item td { font-size: 0.9em; color: #c0c0c0; border-color: #383838; }
        .lot-sub-item td:nth-child(2) { padding-left: 35px; }
        .reasoning-row { display: none; background-color: #222 !important; }
        .reasoning-row.visible { display: table-row; }
        .reasoning-row td {
            padding: 10px 20px 10px 40px;
            font-style: italic;
            color: #b0b0b0;
            border-top: 1px dashed #555;
            white-space: normal;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <h1>Auction Item Analysis</h1>
    <div class="table-container"><table><thead><tr><th data-column="lot_number">Lot # <span class="sort-indicator"></span></th><th data-column="name">Item Name <span class="sort-indicator"></span></th><th data-column="category">Category <span class="sort-indicator"></span></th><th data-column="price">AI Market Value <span class="sort-indicator"></span></th><th data-column="ebay_price">eBay Avg. Sold <span class="sort-indicator"></span></th><th data-column="confidence">Confidence <span class="sort-indicator"></span></th><th>eBay Search</th><th>Google Search</th></tr></thead><tbody id="data-table-body"></tbody></table></div>

<script type="application/json" id="auctionData">
    [
    {
        "ebay_search_title": "Coach Legacy Stripe Duffle Shoulder Bag 19389 Multicolor Canvas Tan Leather Purse",
        "category": "Collectibles",
        "total_market_value": 25,
        "items": [
            {
                "item_name": "Coach Legacy Stripe Duffle Shoulder Bag 19389 Multicolor Canvas Tan Leather Purse",
                "estimated_value": 25,
                "ebay_avg_price": 51.592
            }
        ],
        "original_listing": {
            "post_id": "https://greatfindsauction.com/Event/LotDetails/59556140/Coach-Purse",
            "title": "Coach Purse",
            "lot_number": 4,
            "current_bid": "$3.00",
            "url": "https://greatfindsauction.com/Event/LotDetails/59556140/Coach-Purse",
            "pics": [
                "595561401.jpg",
                "595561402.jpg",
                "595561403.jpg",
                "595561404.jpg",
                "595561405.jpg",
                "595561406.jpg",
                "595561407.jpg",
                "595561408.jpg",
                "595561409.jpg",
                "5955614010.jpg",
                "5955614011.jpg",
                "5955614012.jpg",
                "5955614013.jpg",
                "5955614014.jpg",
                "5955614015.jpg",
                "5955614016.jpg"
            ]
        },
        "reasoning": "This is an authentic Coach bag, but it's an older style with visible wear and staining on the leather base. The valuation is based on sold prices for the same model in similar fair condition, which reduces its value.",
        "lot_number": 4,
        "ebay_avg_price": 51.592,
        "ebay_confidence_score": 65,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Coach+Legacy+Stripe+Duffle+Shoulder+Bag+19389+Multicolor+Canvas+Tan+Leather+Purse&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "New Patricia Nash First Bloom Italian Leather Wristlet Clutch Purse Floral NWT",
        "category": "Collectibles",
        "total_market_value": 35,
        "items": [
            {
                "item_name": "New Patricia Nash First Bloom Italian Leather Wristlet Clutch Purse Floral NWT",
                "estimated_value": 35,
                "ebay_avg_price": 46.22392857142857
            }
        ],
        "original_listing": {
            "post_id": "https://greatfindsauction.com/Event/LotDetails/59553704/New-Patricia-Nash-Leather-Clutch-Wristlet-Purse",
            "title": "New Patricia Nash Leather Clutch/ Wristlet Purse",
            "lot_number": 1,
            "current_bid": "$5.00",
            "url": "https://greatfindsauction.com/Event/LotDetails/59553704/New-Patricia-Nash-Leather-Clutch-Wristlet-Purse",
            "pics": [
                "595537041.jpg",
                "595537042.jpg",
                "595537043.jpg",
                "595537044.jpg",
                "595537045.jpg",
                "595537046.jpg",
                "595537047.jpg"
            ]
        },
        "reasoning": "The valuation is based on sold listings for similar new-with-tags Patricia Nash leather wristlets on eBay. The brand is popular and the item is in new condition, supporting a resale value of around $35.",
        "lot_number": 1,
        "ebay_avg_price": 46.22392857142857,
        "ebay_confidence_score": 85,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=New+Patricia+Nash+First+Bloom+Italian+Leather+Wristlet+Clutch+Purse+Floral+NWT&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "New Hallmark Pineapple Lemonade Scented Soy Blend Candle 3-Wick 16 oz Jar",
        "category": "Decor/Lighting",
        "total_market_value": 18,
        "items": [
            {
                "item_name": "New Hallmark Pineapple Lemonade Scented Soy Blend Candle 3-Wick 16 oz Jar",
                "estimated_value": 18,
                "ebay_avg_price": 23.843333333333334
            }
        ],
        "original_listing": {
            "post_id": "https://greatfindsauction.com/Event/LotDetails/59918400/New-Hallmark-Jar-Candle",
            "title": "New Hallmark Jar Candle",
            "lot_number": 200,
            "current_bid": "$3.00",
            "url": "https://greatfindsauction.com/Event/LotDetails/59918400/New-Hallmark-Jar-Candle",
            "pics": [
                "599184001.jpg",
                "599184002.jpg",
                "599184003.jpg"
            ]
        },
        "reasoning": "The candle is new, but its resale value is considerably less than its original $29.99 retail price. The valuation is based on comparable sold listings for new Hallmark 16oz 3-wick candles.",
        "lot_number": 200,
        "ebay_avg_price": 23.843333333333334,
        "ebay_confidence_score": 100,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=New+Hallmark+Pineapple+Lemonade+Scented+Soy+Blend+Candle+3-Wick+16+oz+Jar&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "New White Faux Leather Crossbody Cell Phone Purse Bag with Fringe Tassel",
        "category": "Miscellaneous",
        "total_market_value": 15,
        "items": [
            {
                "item_name": "New White Faux Leather Crossbody Cell Phone Purse Bag with Fringe Tassel",
                "estimated_value": 15,
                "ebay_avg_price": 17.95
            }
        ],
        "original_listing": {
            "post_id": "https://greatfindsauction.com/Event/LotDetails/59554998/New-Leather-Crossbody-Purse",
            "title": "New Leather Crossbody Purse",
            "lot_number": 3,
            "current_bid": "$1.00",
            "url": "https://greatfindsauction.com/Event/LotDetails/59554998/New-Leather-Crossbody-Purse",
            "pics": [
                "595549981.jpg",
                "595549982.jpg",
                "595549983.jpg",
                "595549984.jpg",
                "595549985.jpg",
                "595549986.jpg",
                "595549987.jpg"
            ]
        },
        "reasoning": "The purse is unbranded and appears to be a generic, mass-produced fashion accessory. The value is based on the typical resale price for similar new, unbranded crossbody phone purses found on online marketplaces.",
        "lot_number": 3,
        "ebay_avg_price": 17.95,
        "ebay_confidence_score": 60,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=New+White+Faux+Leather+Crossbody+Cell+Phone+Purse+Bag+with+Fringe+Tassel&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "Mary Kay Silver Metallic Tote Bag Purse Embossed Hearts Promotional",
        "category": "Miscellaneous",
        "total_market_value": 12,
        "items": [
            {
                "item_name": "Mary Kay Silver Metallic Tote Bag Purse Embossed Hearts Promotional",
                "estimated_value": 12,
                "ebay_avg_price": 0.0
            }
        ],
        "original_listing": {
            "post_id": "https://greatfindsauction.com/Event/LotDetails/59554195/Mary-Kay-Silver-Tote-Bag",
            "title": "Mary Kay Silver Tote Bag",
            "lot_number": 2,
            "current_bid": "$1.00",
            "url": "https://greatfindsauction.com/Event/LotDetails/59554195/Mary-Kay-Silver-Tote-Bag",
            "pics": [
                "595541951.jpg",
                "595541952.jpg",
                "595541953.jpg",
                "595541954.jpg",
                "595541955.jpg",
                "595541956.jpg",
                "595541957.jpg"
            ]
        },
        "reasoning": "This is a promotional item from Mary Kay, which has a very low resale value. The valuation of $12 is based on comparable sold listings for similar consultant gift bags, which are plentiful and inexpensive.",
        "lot_number": 2,
        "ebay_avg_price": 0.0,
        "ebay_confidence_score": 0,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Mary+Kay+Silver+Metallic+Tote+Bag+Purse+Embossed+Hearts+Promotional&_sacat=0&LH_Complete=1&LH_Sold=1"
    }
]
</script>

<script>
    const jsonData = JSON.parse(document.getElementById('auctionData').textContent);
    const tableBody = document.getElementById('data-table-body');
    const headers = document.querySelectorAll('thead th[data-column]');
    let currentSort = { column: 'ebay_price', isAscending: false };

    function populateTable() {
        tableBody.innerHTML = '';
        const formatCurrency = (value) => (value || 0).toLocaleString('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0 });
        const sanitizeText = (text) => (text || 'No reasoning provided.');

        jsonData.forEach(lot => {
            const hasReasoning = lot.reasoning && lot.reasoning.trim() !== '';
            
            const mainRow = document.createElement('tr');
            mainRow.className = 'lot-main' + (hasReasoning ? ' expandable' : '');
            
            const encodedSearch = encodeURIComponent(lot.ebay_search_title || '');
            
            mainRow.innerHTML = `
                <td>${lot.lot_number > 0 ? lot.lot_number : ''}</td>
                <td><a href="${lot.original_listing.url}" target="_blank" title="${lot.original_listing.title}">${lot.ebay_search_title || 'N/A'}</a></td>
                <td>${lot.category || 'Miscellaneous'}</td>
                <td style="text-align: right;">${formatCurrency(lot.total_market_value)}</td>
                <td style="text-align: right;">${lot.ebay_avg_price > 0 ? formatCurrency(lot.ebay_avg_price) : 'N/A'}</td>
                <td style="text-align: right;">${lot.ebay_confidence_score > 0 ? lot.ebay_confidence_score + '%' : 'N/A'}</td>
                <td style="text-align: center;"><a href="${lot.ebay_search_url || '#'}" target="_blank">eBay</a></td>
                <td style="text-align: center;"><a href="https://www.google.com/search?q=${encodedSearch}" target="_blank">Google</a></td>
            `;
            
            tableBody.appendChild(mainRow);
            
            if (hasReasoning) {
                const reasoningRow = document.createElement('tr');
                reasoningRow.className = 'reasoning-row';
                reasoningRow.innerHTML = `<td colspan="8">${sanitizeText(lot.reasoning)}</td>`;
                tableBody.appendChild(reasoningRow);

                mainRow.addEventListener('click', () => {
                    reasoningRow.classList.toggle('visible');
                });
            }

            if (lot.items && lot.items.length > 1) {
                lot.items.forEach(subItem => {
                    const subRow = document.createElement('tr');
                    subRow.className = 'lot-sub-item';
                    
                    const subAvgPrice = subItem.ebay_avg_price || 0;
                    const subEncodedSearch = encodeURIComponent(subItem.item_name || '');
                    const subEbayUrl = `https://www.ebay.com/sch/i.html?_from=R40&_nkw=${subEncodedSearch}&_sacat=0&LH_Complete=1&LH_Sold=1`;
                    const subGoogleUrl = `https://www.google.com/search?q=${subEncodedSearch}`;

                    subRow.innerHTML = `
                        <td></td>
                        <td style="padding-left: 35px;">${subItem.item_name || 'N/A'}</td>
                        <td></td>
                        <td style="text-align: right;">${formatCurrency(subItem.estimated_value)}</td>
                        <td style="text-align: right;">${subAvgPrice > 0 ? formatCurrency(subAvgPrice) : 'N/A'}</td>
                        <td></td>
                        <td style="text-align: center;"><a href="${subEbayUrl}" target="_blank">eBay</a></td>
                        <td style="text-align: center;"><a href="${subGoogleUrl}" target="_blank">Google</a></td>
                    `;
                    tableBody.appendChild(subRow);
                });
            }
        });
    }

    function sortData(column) {
        const isNumeric = ['price', 'ebay_price', 'lot_number', 'confidence'].includes(column);
        if (currentSort.column === column) {
            currentSort.isAscending = !currentSort.isAscending;
        } else {
            currentSort.column = column;
            currentSort.isAscending = !isNumeric;
        }

        jsonData.sort((a, b) => {
            let valA, valB;
            switch (column) {
                case 'price': valA = a.total_market_value || 0; valB = b.total_market_value || 0; break;
                case 'ebay_price': valA = a.ebay_avg_price || 0; valB = b.ebay_avg_price || 0; break;
                case 'confidence': valA = a.ebay_confidence_score || 0; valB = b.ebay_confidence_score || 0; break;
                case 'lot_number': valA = a.lot_number || 0; valB = b.lot_number || 0; break;
                case 'name': valA = (a.ebay_search_title || '').toLowerCase(); valB = (b.ebay_search_title || '').toLowerCase(); break;
                case 'category': valA = (a.category || '').toLowerCase(); valB = (b.category || '').toLowerCase(); break;
                default: return 0;
            }
            let comparison = 0;
            if (valA > valB) { comparison = 1; }
            else if (valA < valB) { comparison = -1; }
            return currentSort.isAscending ? comparison : comparison * -1;
        });
        updateSortIndicators();
        populateTable();
    }

    function updateSortIndicators() {
        headers.forEach(header => {
            const indicator = header.querySelector('.sort-indicator');
            if (header.dataset.column === currentSort.column) {
                indicator.textContent = currentSort.isAscending ? ' ▲' : ' ▼';
            } else { indicator.textContent = ''; }
        });
    }

    headers.forEach(header => { header.addEventListener('click', () => { sortData(header.dataset.column); }); });
    sortData('ebay_price');
</script>

    <div style="text-align: center; margin-top: 2rem; font-size: 0.8em; color: #888;">
        <p>Analysis powered by:</p>
        <p><strong>Auction Analysis Model:</strong> gemini-2.5-pro (Gemini)</p>
        <p><strong>eBay Cleaning Model(s):</strong> gemini-flash-latest (Gemini)</p>
    </div>

</body>
</html>
