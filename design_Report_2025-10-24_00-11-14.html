
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auction Item Analysis</title>
    <style>
        :root {
            --bg-color: #1a1a1a; --table-bg-color: #2c2c2c; --header-bg-color: #3a3a3a;
            --header-hover-bg-color: #4a4a4a; --row-even-bg-color: #333333; --row-odd-bg-color: #2c2c2c;
            --border-color: #444444; --text-color: #e0e0e0; --link-color: #4a90e2;
            --link-hover-color: #81b5f5; --sort-indicator-color: #81b5f5;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 2rem; line-height: 1.6; }
        h1 { text-align: center; color: #ffffff; font-weight: 300; margin-bottom: 2rem; }
        .controls-container { max-width: 1600px; margin: auto; margin-bottom: 1rem; }
        .filter-container { text-align: left; padding: 10px 15px; background-color: var(--table-bg-color); border-radius: 8px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); }
        .filter-container label { margin-right: 20px; font-size: 0.9em; cursor: pointer; user-select: none; }
        .filter-container input { vertical-align: middle; margin-right: 5px; }
        .table-container { max-width: 1600px; margin: auto; overflow-x: auto; border-radius: 8px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); }
        table { width: 100%; border-collapse: collapse; background-color: var(--table-bg-color); border-spacing: 0; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid var(--border-color); }
        thead th { background-color: var(--header-bg-color); color: #ffffff; font-weight: 600; position: sticky; top: 0; z-index: 10; }
        thead th[data-column] { cursor: pointer; transition: background-color 0.2s ease-in-out; user-select: none; }
        thead th[data-column]:hover { background-color: var(--header-hover-bg-color); }
        tbody tr:not(.reasoning-row):hover { background-color: var(--header-hover-bg-color); }
        td { font-size: 0.95em; }
        td:nth-child(4), td:nth-child(5), td:nth-child(6) { font-family: 'Courier New', Courier, monospace; text-align: right; white-space: nowrap; }
        td:nth-child(7), td:nth-child(8) { text-align: center; }
        a { color: var(--link-color); text-decoration: none; transition: color 0.2s ease-in-out; }
        a:hover { color: var(--link-hover-color); text-decoration: underline; }
        .sort-indicator { color: var(--sort-indicator-color); font-size: 0.8em; margin-left: 8px; display: inline-block; width: 10px; }
        .lot-main td { font-weight: bold; }
        .lot-main.expandable { cursor: pointer; }
        .lot-main:nth-child(4n+1), .lot-main:nth-child(4n+2) { background-color: var(--row-odd-bg-color); }
        .lot-main:nth-child(4n+3), .lot-main:nth-child(4n) { background-color: var(--row-even-bg-color); }
        .lot-sub-item { background-color: rgba(0,0,0,0.15) !important; }
        .lot-sub-item td { font-size: 0.9em; color: #c0c0c0; border-color: #383838; }
        .lot-sub-item td:nth-child(2) { padding-left: 35px; }
        .reasoning-row { display: none; background-color: #222 !important; }
        .reasoning-row.visible { display: table-row; }
        .reasoning-row td {
            padding: 10px 20px 10px 40px;
            font-style: italic;
            color: #b0b0b0;
            border-top: 1px dashed #555;
            white-space: normal;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <h1>Auction Item Analysis</h1>
    <div class="controls-container">
        <div class="filter-container">
            <label><input type="checkbox" id="hideFurniture"> Hide Large Furniture</label>
            <label><input type="checkbox" id="hideMedical"> Hide Medical Devices</label>
        </div>
    </div>
    <div class="table-container"><table><thead><tr><th data-column="lot_number">Lot # <span class="sort-indicator"></span></th><th data-column="name">Item Name <span class="sort-indicator"></span></th><th data-column="category">Category <span class="sort-indicator"></span></th><th data-column="price">AI Market Value <span class="sort-indicator"></span></th><th data-column="ebay_price">eBay Avg. Sold <span class="sort-indicator"></span></th><th data-column="confidence">Confidence <span class="sort-indicator"></span></th><th>eBay Search</th><th>Google Search</th></tr></thead><tbody id="data-table-body"></tbody></table></div>

<script type="application/json" id="auctionData">
    [
    {
        "ebay_search_title": "Tiffany Style Stained Glass Hanging Lamp Shade",
        "category": "Decor/Lighting",
        "is_shippable": true,
        "total_market_value": 250,
        "items": [
            {
                "item_name": "Tiffany Style Stained Glass Hanging Lamp Shade",
                "estimated_value": 250,
                "ebay_avg_price": 105.72777777777777
            }
        ],
        "original_listing": {
            "post_id": "https://auctions.transitionaldesign.net/Event/LotDetails/89236070/Hanging-lamp-shade",
            "title": "Hanging lamp shade",
            "lot_number": 7,
            "url": "https://auctions.transitionaldesign.net/Event/LotDetails/89236070/Hanging-lamp-shade",
            "pics": [
                "89236070_1.jpg",
                "89236070_2.jpg",
                "89236070_3.jpg",
                "89236070_4.jpg",
                "89236070_5.jpg",
                "89236070_6.jpg",
                "89236070_7.jpg"
            ]
        },
        "reasoning": "The stained glass hanging lamp shade is a high-quality, decorative item with a classic Tiffany style design. The images show the shade from multiple angles, highlighting its intricate details and craftsmanship. The estimated value is based on the shade's condition, size, and style, which is consistent with similar items sold online. To increase its value, consider adding a compatible lamp base or restoring any damaged parts. I analyzed 7 images for this item.",
        "lot_number": 7,
        "ebay_avg_price": 105.72777777777777,
        "ebay_confidence_score": 90,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Tiffany+Style+Stained+Glass+Hanging+Lamp+Shade&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "Craftsman Snow Blower",
        "category": "Tools/Equipment",
        "is_shippable": false,
        "total_market_value": 250,
        "items": [
            {
                "item_name": "Craftsman Single-Stage Snow Blower",
                "estimated_value": 250
            }
        ],
        "original_listing": {
            "post_id": "https://auctions.transitionaldesign.net/Event/LotDetails/89235424/Craftsman-Snow-Blower",
            "title": "Craftsman Snow Blower",
            "lot_number": 1,
            "url": "https://auctions.transitionaldesign.net/Event/LotDetails/89235424/Craftsman-Snow-Blower",
            "pics": [
                "89235424_1.jpg",
                "89235424_2.jpg",
                "89235424_3.jpg",
                "89235424_4.jpg",
                "89235424_5.jpg",
                "89235424_6.jpg",
                "89235424_7.jpg"
            ]
        },
        "reasoning": "The Craftsman snow blower appears to be in good condition based on the images provided. The engine and other components seem intact and functional. The snow blower is a single-stage model, which is suitable for light to moderate snowfall. The estimated value of $250 is based on the assumption that it is a functional and relatively recent model. For resale, it's advisable to highlight its condition, any maintenance or repairs done, and its suitability for specific snow clearing needs. I analyzed 7 images for this item.",
        "lot_number": 1,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Craftsman+Snow+Blower&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "Frigidaire Commercial Freezer",
        "category": "Tools/Equipment",
        "is_shippable": false,
        "total_market_value": 800,
        "items": [
            {
                "item_name": "Frigidaire Commercial Freezer",
                "estimated_value": 800
            }
        ],
        "original_listing": {
            "post_id": "https://auctions.transitionaldesign.net/Event/LotDetails/89235976/Frigidaire-Commerical-Freezer",
            "title": "Frigidaire Commerical Freezer",
            "lot_number": 2,
            "url": "https://auctions.transitionaldesign.net/Event/LotDetails/89235976/Frigidaire-Commerical-Freezer",
            "pics": [
                "89235976_1.jpg",
                "89235976_2.jpg",
                "89235976_3.jpg",
                "89235976_4.jpg",
                "89235976_5.jpg",
                "89235976_6.jpg",
                "89235976_7.jpg",
                "89235976_8.jpg",
                "89235976_9.jpg",
                "89235976_10.jpg",
                "89235976_11.jpg"
            ]
        },
        "reasoning": "The Frigidaire Commercial Freezer appears to be in good condition based on the provided images. The total market value is estimated at $800, considering its brand, model, and condition. The item is not shippable due to its size and weight. To increase its value, consider including any additional features or accessories, such as shelves or baskets, and ensure it is clean and functional. I analyzed 5 images for this item.",
        "lot_number": 2,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Frigidaire+Commercial+Freezer&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "Dining Table Set with 6 Chairs",
        "category": "Large Furniture",
        "is_shippable": false,
        "total_market_value": 400,
        "items": [
            {
                "item_name": "Dining Table",
                "estimated_value": 150
            },
            {
                "item_name": "6 Dining Chairs",
                "estimated_value": 250
            }
        ],
        "original_listing": {
            "post_id": "https://auctions.transitionaldesign.net/Event/LotDetails/89235995/Dining-Set",
            "title": "Dining Set",
            "lot_number": 3,
            "url": "https://auctions.transitionaldesign.net/Event/LotDetails/89235995/Dining-Set",
            "pics": [
                "89235995_1.jpg",
                "89235995_2.jpg",
                "89235995_3.jpg",
                "89235995_4.jpg",
                "89235995_5.jpg",
                "89235995_6.jpg",
                "89235995_7.jpg",
                "89235995_8.jpg",
                "89235995_9.jpg",
                "89235995_10.jpg",
                "89235995_11.jpg",
                "89235995_12.jpg",
                "89235995_13.jpg",
                "89235995_14.jpg",
                "89235995_15.jpg",
                "89235995_16.jpg"
            ]
        },
        "reasoning": "The dining set includes a table and six chairs, with visible wear and tear on the tabletop and chairs. The condition affects the overall value. The total market value is estimated at $400, with the table valued at $150 and the six chairs at $250. To increase value, consider refurbishing or repainting the chairs and restoring the tabletop. I analyzed 5 images for this item.",
        "lot_number": 3,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Dining+Table+Set+with+6+Chairs&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "Samsung QN83Q7FRAF 83\" QLED TV with Wall Mount",
        "category": "Electronics",
        "is_shippable": false,
        "total_market_value": 4000,
        "items": [
            {
                "item_name": "Samsung QN83Q7FRAF 83\" QLED TV",
                "estimated_value": 3800
            },
            {
                "item_name": "Samsung Wall Mount for QLED TV",
                "estimated_value": 200
            }
        ],
        "original_listing": {
            "post_id": "https://auctions.transitionaldesign.net/Event/LotDetails/89235688/Samsung-Wall-Mount-Television-83",
            "title": "Samsung Wall Mount Television / 83\"",
            "lot_number": 4,
            "url": "https://auctions.transitionaldesign.net/Event/LotDetails/89235688/Samsung-Wall-Mount-Television-83",
            "pics": [
                "89235688_1.jpg",
                "89235688_2.jpg",
                "89235688_3.jpg",
                "89235688_4.jpg",
                "89235688_5.jpg",
                "89235688_6.jpg"
            ]
        },
        "reasoning": "The lot includes a Samsung 83\" QLED TV (QN83Q7FRAF) and its wall mount. The TV is a high-end model with advanced features, contributing to its significant value. The wall mount, while important for installation, is less valuable compared to the TV itself. The total market value is estimated based on the TV's model, size, and condition. I analyzed 6 images for this item, which showed the TV's features, model number, and the included wall mount, supporting the estimated value. Potential buyers should note that the TV's condition and any additional accessories (like the original packaging or remote) can impact its resale value. Expert resellers should verify the TV's functionality and cosmetic condition to maximize profit.",
        "lot_number": 4,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Samsung+QN83Q7FRAF+83%22+QLED+TV+with+Wall+Mount&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "Phillips & Clark Cast Iron Furnace with Ornate Details",
        "category": "Large Furniture",
        "is_shippable": false,
        "total_market_value": 800,
        "items": [
            {
                "item_name": "Phillips & Clark Cast Iron Furnace",
                "estimated_value": 800
            }
        ],
        "original_listing": {
            "post_id": "https://auctions.transitionaldesign.net/Event/LotDetails/89299473/Phillips-Clark-Cast-Iron-Furnace",
            "title": "Phillips & Clark Cast Iron Furnace",
            "lot_number": 5,
            "url": "https://auctions.transitionaldesign.net/Event/LotDetails/89299473/Phillips-Clark-Cast-Iron-Furnace",
            "pics": [
                "89299473_1.jpg",
                "89299473_2.jpg",
                "89299473_3.jpg",
                "89299473_4.jpg",
                "89299473_5.jpg",
                "89299473_6.jpg",
                "89299473_7.jpg",
                "89299473_8.jpg",
                "89299473_9.jpg",
                "89299473_10.jpg",
                "89299473_11.jpg",
                "89299473_12.jpg"
            ]
        },
        "reasoning": "The Phillips & Clark Cast Iron Furnace is a unique and decorative piece that could be valuable to collectors or those looking for a vintage heating solution. The ornate details and cast iron construction suggest a high level of craftsmanship, contributing to its value. I analyzed 5 images that showed the furnace from various angles, highlighting its condition and features. To increase its value, consider restoring or refurbishing it to its original condition, and highlighting its historical significance or unique features in the listing. The total market value is estimated at $800.",
        "lot_number": 5,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Phillips+%26+Clark+Cast+Iron+Furnace+with+Ornate+Details&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "Antique Chippendale Style Secretary Desk",
        "category": "Large Furniture",
        "is_shippable": false,
        "total_market_value": 800,
        "items": [
            {
                "item_name": "Antique Chippendale Style Secretary Desk with Hutch",
                "estimated_value": 800
            }
        ],
        "original_listing": {
            "post_id": "https://auctions.transitionaldesign.net/Event/LotDetails/89236049/Secretary-Chippendale-Style",
            "title": "Secretary / Chippendale Style",
            "lot_number": 6,
            "url": "https://auctions.transitionaldesign.net/Event/LotDetails/89236049/Secretary-Chippendale-Style",
            "pics": [
                "89236049_1.jpg",
                "89236049_2.jpg",
                "89236049_3.jpg",
                "89236049_4.jpg",
                "89236049_5.jpg",
                "89236049_6.jpg",
                "89236049_7.jpg",
                "89236049_8.jpg"
            ]
        },
        "reasoning": "The secretary desk is a single, high-value item. It is an antique piece in the style of Chippendale, known for its intricate design and craftsmanship. The presence of multiple drawers, a hutch with glass doors, and a fold-down writing surface indicates a high level of functionality and storage, which adds to its value. The condition appears to be good based on the images provided, with no visible major damages. The estimated value is $800, reflecting its antique status, design, and functionality. I analyzed 5 images for this item. To increase its value, consider restoring or refinishing it to highlight its original charm, and provide detailed photos of its condition and features when reselling.",
        "lot_number": 6,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Antique+Chippendale+Style+Secretary+Desk&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "Purifi Custom Speakers",
        "category": "Electronics",
        "is_shippable": false,
        "total_market_value": 800,
        "items": [
            {
                "item_name": "Purifi Custom Speaker",
                "estimated_value": 400
            },
            {
                "item_name": "Purifi Custom Speaker",
                "estimated_value": 400
            }
        ],
        "original_listing": {
            "post_id": "https://auctions.transitionaldesign.net/Event/LotDetails/89331760/Custom-Purifi-Speakers",
            "title": "Custom Purifi Speakers",
            "lot_number": 8,
            "url": "https://auctions.transitionaldesign.net/Event/LotDetails/89331760/Custom-Purifi-Speakers",
            "pics": [
                "89331760_1.jpg",
                "89331760_2.jpg",
                "89331760_3.jpg",
                "89331760_4.jpg",
                "89331760_5.jpg",
                "89331760_6.jpg",
                "89331760_7.jpg",
                "89331760_8.jpg",
                "89331760_9.jpg",
                "89331760_10.jpg",
                "89331760_11.jpg",
                "89331760_12.jpg",
                "89331760_13.jpg"
            ]
        },
        "reasoning": "The speakers appear to be custom-made with Purifi drivers, which are high-end components. The damage to the woofer surround may affect their functionality, potentially reducing their value. I've priced them at $400 each, considering their custom nature and the damage. Resellers could consider repairing or replacing the damaged surrounds to increase the speakers' value. I analyzed 5 images for this item.",
        "lot_number": 8,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Purifi+Custom+Speakers&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "Whirlpool French Door Refrigerator",
        "category": "Large Furniture",
        "is_shippable": false,
        "total_market_value": 1200,
        "items": [
            {
                "item_name": "Whirlpool French Door Refrigerator with Water Dispenser",
                "estimated_value": 1200
            }
        ],
        "original_listing": {
            "post_id": "https://auctions.transitionaldesign.net/Event/LotDetails/89236127/Whirlpool-Refrigerator",
            "title": "Whirlpool Refrigerator",
            "lot_number": 9,
            "url": "https://auctions.transitionaldesign.net/Event/LotDetails/89236127/Whirlpool-Refrigerator",
            "pics": [
                "89236127_1.jpg",
                "89236127_2.jpg",
                "89236127_3.jpg",
                "89236127_4.jpg",
                "89236127_5.jpg",
                "89236127_6.jpg",
                "89236127_7.jpg",
                "89236127_8.jpg",
                "89236127_9.jpg",
                "89236127_10.jpg",
                "89236127_11.jpg",
                "89236127_12.jpg"
            ]
        },
        "reasoning": "The listed item is a Whirlpool French Door Refrigerator with a water dispenser. The images provided show the exterior and interior of the appliance, indicating it is in good condition. The total market value is estimated at $1200 based on the assumption that it is a high-end model with advanced features. Expert reseller advice: Highlight the features such as the water dispenser and French door design in the listing title and description to attract potential buyers. Emphasize the condition and any unique features. I analyzed 5 images for this item.",
        "lot_number": 9,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Whirlpool+French+Door+Refrigerator&_sacat=0&LH_Complete=1&LH_Sold=1"
    },
    {
        "ebay_search_title": "Antique Oak Church Pew with Cushion",
        "category": "Large Furniture",
        "is_shippable": false,
        "total_market_value": 250,
        "items": [
            {
                "item_name": "Antique Oak Church Pew",
                "estimated_value": 200
            },
            {
                "item_name": "Church Pew Cushion",
                "estimated_value": 50
            }
        ],
        "original_listing": {
            "post_id": "https://auctions.transitionaldesign.net/Event/LotDetails/89244012/Church-Pew-Cushion-Large",
            "title": "Church Pew / Cushion /Large",
            "lot_number": 10,
            "url": "https://auctions.transitionaldesign.net/Event/LotDetails/89244012/Church-Pew-Cushion-Large",
            "pics": [
                "89244012_1.jpg",
                "89244012_2.jpg",
                "89244012_3.jpg",
                "89244012_4.jpg",
                "89244012_5.jpg"
            ]
        },
        "reasoning": "The lot includes an antique oak church pew and a cushion. The pew is a solid oak piece with a classic design, likely from the early 20th century. The cushion is a simple, gray fabric item. The total market value is estimated to be $250, with the pew accounting for $200 and the cushion $50. The pew's value comes from its age, material, and historical significance. The lot is not shippable due to the size and weight of the pew. I analyzed 5 images for this item.",
        "lot_number": 10,
        "ebay_search_url": "https://www.ebay.com/sch/i.html?_from=R40&_nkw=Antique+Oak+Church+Pew+with+Cushion&_sacat=0&LH_Complete=1&LH_Sold=1"
    }
]
</script>

<script>
    const fullJsonData = JSON.parse(document.getElementById('auctionData').textContent);
    let currentFilteredData = [...fullJsonData];
    
    const tableBody = document.getElementById('data-table-body');
    const headers = document.querySelectorAll('thead th[data-column]');
    const hideFurnitureCheckbox = document.getElementById('hideFurniture');
    const hideMedicalCheckbox = document.getElementById('hideMedical');

    let currentSort = { column: 'ebay_price', isAscending: false };

    function applyFiltersAndRepopulate() {
        const hideFurniture = hideFurnitureCheckbox.checked;
        const hideMedical = hideMedicalCheckbox.checked;

        currentFilteredData = fullJsonData.filter(lot => {
            const category = (lot.category || '').toLowerCase();
            if (hideFurniture && category === 'large furniture') {
                return false;
            }
            if (hideMedical && category === 'medical devices') {
                return false;
            }
            return true;
        });

        sortData(currentSort.column, true);
    }

    function populateTable() {
        tableBody.innerHTML = '';
        const formatCurrency = (value) => (value || 0).toLocaleString('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0 });
        const sanitizeText = (text) => (text || 'No reasoning provided.');

        currentFilteredData.forEach(lot => {
            const hasReasoning = lot.reasoning && lot.reasoning.trim() !== '';
            
            const mainRow = document.createElement('tr');
            mainRow.className = 'lot-main' + (hasReasoning ? ' expandable' : '');
            
            const encodedSearch = encodeURIComponent(lot.ebay_search_title || '');
            
            mainRow.innerHTML = `
                <td>${lot.lot_number > 0 ? lot.lot_number : ''}</td>
                <td><a href="${lot.original_listing.url}" target="_blank" title="${lot.original_listing.title}">${lot.ebay_search_title || 'N/A'}</a></td>
                <td>${lot.category || 'Miscellaneous'}</td>
                <td style="text-align: right;">${formatCurrency(lot.total_market_value)}</td>
                <td style="text-align: right;">${lot.ebay_avg_price > 0 ? formatCurrency(lot.ebay_avg_price) : 'N/A'}</td>
                <td style="text-align: right;">${lot.ebay_confidence_score > 0 ? lot.ebay_confidence_score + '%' : 'N/A'}</td>
                <td style="text-align: center;"><a href="${lot.ebay_search_url || '#'}" target="_blank">eBay</a></td>
                <td style="text-align: center;"><a href="https://www.google.com/search?q=${encodedSearch}" target="_blank">Google</a></td>
            `;
            
            tableBody.appendChild(mainRow);
            
            if (hasReasoning) {
                const reasoningRow = document.createElement('tr');
                reasoningRow.className = 'reasoning-row';
                reasoningRow.innerHTML = `<td colspan="8">${sanitizeText(lot.reasoning)}</td>`;
                tableBody.appendChild(reasoningRow);

                mainRow.addEventListener('click', () => {
                    reasoningRow.classList.toggle('visible');
                });
            }

            if (lot.items && lot.items.length > 1) {
                lot.items.forEach(subItem => {
                    const subRow = document.createElement('tr');
                    subRow.className = 'lot-sub-item';
                    
                    const subAvgPrice = subItem.ebay_avg_price || 0;
                    const subEncodedSearch = encodeURIComponent(subItem.item_name || '');
                    const subEbayUrl = `https://www.ebay.com/sch/i.html?_from=R40&_nkw=${subEncodedSearch}&_sacat=0&LH_Complete=1&LH_Sold=1`;
                    const subGoogleUrl = `https://www.google.com/search?q=${subEncodedSearch}`;

                    subRow.innerHTML = `
                        <td></td>
                        <td style="padding-left: 35px;">${subItem.item_name || 'N/A'}</td>
                        <td></td>
                        <td style="text-align: right;">${formatCurrency(subItem.estimated_value)}</td>
                        <td style="text-align: right;">${subAvgPrice > 0 ? formatCurrency(subAvgPrice) : 'N/A'}</td>
                        <td></td>
                        <td style="text-align: center;"><a href="${subEbayUrl}" target="_blank">eBay</a></td>
                        <td style="text-align: center;"><a href="${subGoogleUrl}" target="_blank">Google</a></td>
                    `;
                    tableBody.appendChild(subRow);
                });
            }
        });
    }

    function sortData(column, keepDirection = false) {
        const isNumeric = ['price', 'ebay_price', 'lot_number', 'confidence'].includes(column);

        if (!keepDirection) {
            if (currentSort.column === column) {
                currentSort.isAscending = !currentSort.isAscending;
            } else {
                currentSort.column = column;
                currentSort.isAscending = !isNumeric;
            }
        } else if (currentSort.column !== column) {
             currentSort.column = column;
             currentSort.isAscending = !isNumeric;
        }

        currentFilteredData.sort((a, b) => {
            let valA, valB;
            switch (column) {
                case 'price': valA = a.total_market_value || 0; valB = b.total_market_value || 0; break;
                case 'ebay_price': valA = a.ebay_avg_price || 0; valB = b.ebay_avg_price || 0; break;
                case 'confidence': valA = a.ebay_confidence_score || 0; valB = b.ebay_confidence_score || 0; break;
                case 'lot_number': valA = a.lot_number || 0; valB = b.lot_number || 0; break;
                case 'name': valA = (a.ebay_search_title || '').toLowerCase(); valB = (b.ebay_search_title || '').toLowerCase(); break;
                case 'category': valA = (a.category || '').toLowerCase(); valB = (b.category || '').toLowerCase(); break;
                default: return 0;
            }
            let comparison = 0;
            if (valA > valB) { comparison = 1; }
            else if (valA < valB) { comparison = -1; }
            return currentSort.isAscending ? comparison : comparison * -1;
        });
        updateSortIndicators();
        populateTable();
    }

    function updateSortIndicators() {
        headers.forEach(header => {
            const indicator = header.querySelector('.sort-indicator');
            if (header.dataset.column === currentSort.column) {
                indicator.textContent = currentSort.isAscending ? ' ▲' : ' ▼';
            } else { indicator.textContent = ''; }
        });
    }

    headers.forEach(header => { header.addEventListener('click', () => { sortData(header.dataset.column); }); });
    hideFurnitureCheckbox.addEventListener('change', applyFiltersAndRepopulate);
    hideMedicalCheckbox.addEventListener('change', applyFiltersAndRepopulate);

    sortData('ebay_price');
</script>

    <div style="text-align: center; margin-top: 2rem; font-size: 0.8em; color: #888;">
        <p>Analysis powered by:</p>
        <p><strong>Auction Analysis Model:</strong> meta-llama/llama-4-maverick-17b-128e-instruct (Groq)</p>
        <p><strong>eBay Cleaning Model(s):</strong> groq/compound (Groq)</p>
    </div>

</body>
</html>
